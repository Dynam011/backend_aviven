# Backend Granja Avícola - API Documentation

## DescripciónAPI RESTful para gestión de granja avícola, construida con Express, PostgreSQL y Sequelize. Incluye autenticación JWT, roles, y manejo de inventario con transacciones.

## Autenticación- Usa `/api/auth/login` para obtener un token JWT.- Incluye el token en headers: `Authorization: Bearer <token>`.- Roles: Admin (acceso total), Usuario (acceso limitado).

## Endpoints

### Auth- **POST /api/auth/login** Body: `{ "nombre_usuario": "admin", "password": "password123" }` Respuesta: `{ "token": "...", "user": {...} }`### Roles- **GET /api/roles** (Admin) - Lista roles.- **POST /api/roles** (Admin) - Crea rol. Body: `{ "nombre": "NuevoRol", "descripcion": "Desc" }`- **PUT /api/roles/:id** (Admin) - Actualiza rol.- **DELETE /api/roles/:id** (Admin) - Elimina rol.### Usuarios- **GET /api/usuarios** (Admin) - Lista usuarios.- **POST /api/usuarios** (Admin) - Crea usuario. Body: `{ "nombre_usuario": "user", "nombre_completo": "Nombre", "password": "pass123", "id_rol": 1 }`- **PUT /api/usuarios/:id** (Admin) - Actualiza usuario.- **DELETE /api/usuarios/:id** (Admin) - Elimina usuario.### Galpones- **GET /api/galpones** - Lista galpones.- **POST /api/galpones** (Admin) - Crea galpón. Body: `{ "nombre": "Galpón 1", "capacidad": 100 }`- **PUT /api/galpones/:id** (Admin) - Actualiza.- **DELETE /api/galpones/:id** (Admin) - Elimina.### Lotes- **GET /api/lotes** - Lista lotes (incluye galpón).- **POST /api/lotes** (Admin/Usuario) - Crea lote. Body: `{ "codigo_lote": "L001", "fecha_ingreso": "2023-01-01", "cantidad_inicial": 50, "id_galpon": 1 }`- **PUT /api/lotes/:id** (Admin) - Actualiza.- **DELETE /api/lotes/:id** (Admin) - Elimina.### Gallos Reproductores- **GET /api/gallos-reproductores** - Lista registros.- **POST /api/gallos-reproductores** (Admin/Usuario) - Crea. Body: `{ "id_galpon": 1, "cantidad": 10, "fecha_ingreso": "2023-01-01", "estado": "Activo" }`- **PUT /api/gallos-reproductores/:id** (Admin) - Actualiza.- **DELETE /api/gallos-reproductores/:id** (Admin) - Elimina.### Insumos- **GET /api/insumos** - Lista insumos.- **POST /api/insumos** (Admin) - Crea. Body: `{ "nombre": "Maíz", "tipo": "Alimento", "unidad": "kg", "stock_actual": 100, "precio_unitario": 1.50 }`- **PUT /api/insumos/:id** (Admin) - Actualiza.- **DELETE /api/insumos/:id** (Admin) - Elimina.### Producción- **GET /api/produccion** - Lista producciones (incrementa stock automáticamente).- **POST /api/produccion** (Admin/Usuario) - Crea. Body: `{ "id_lote": 1, "id_insumo": 1, "fecha": "2023-01-01", "cantidad": 20 }`- **PUT /api/produccion/:id** (Admin) - Actualiza.- **DELETE /api/produccion/:id** (Admin) - Elimina.### Movimientos Inventario- **GET /api/movimientos-inventario** - Lista movimientos (solo lectura, se insertan automáticamente en compras/ventas/producción).### Proveedores- **GET /api/proveedores** - Lista proveedores.- **POST /api/proveedores** (Admin) - Crea. Body: `{ "nombre": "Proveedor X", "email": "prov@example.com" }`- **PUT /api/proveedores/:id** (Admin) - Actualiza.- **DELETE /api/proveedores/:id** (Admin) - Elimina.### Clientes- **GET /api/clientes** - Lista clientes.- **POST /api/clientes** (Admin/Usuario) - Crea. Body: `{ "nombre": "Cliente Y", "contacto": "123-456", "id_usuario": 1 }`- **PUT /api/clientes/:id** (Admin) - Actualiza.- **DELETE /api/clientes/:id** (Admin) - Elimina.### Compras- **GET /api/compras** - Lista compras (incrementa stock automáticamente).- **POST /api/compras** (Admin) - Crea. Body: `{ "id_proveedor": 1, "id_insumo": 1, "fecha": "2023-01-01", "cantidad": 50, "precio_total": 75 }`- **PUT /api/compras/:id** (Admin) - Actualiza.- **DELETE /api/compras/:id** (Admin) - Elimina.### Ventas- **GET /api/ventas** - Lista ventas.- **POST /api/ventas** (Admin/Usuario) - Crea (decrementa stock automáticamente). Body: `{ "id_cliente": 1, "id_insumo": 1, "fecha": "2023-01-01", "cantidad": 10, "precio_unitario": 2.00, "estado": "Pendiente" }`- **PUT /api/ventas/:id** (Admin) - Actualiza.- **DELETE /api/ventas/:id** (Admin) - Elimina.### Pagos- **GET /api/pagos** - Lista pagos.- **POST /api/pagos** (Admin/Usuario) - Crea. Body: `{ "id_venta": 1, "monto": 20.00, "metodo": "Efectivo" }`- **PUT /api/pagos/:id** (Admin) - Actualiza.- **DELETE /api/pagos/:id** (Admin) - Elimina.
